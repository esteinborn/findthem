"use strict";var TipsApp=angular.module("TipsApp",["TipsApp.filters","ui.bootstrap","ngScrollSpy"]);TipsApp.controller("TipsCtrl",["$scope","$filter","$http","$templateCache","$modal",function($scope,$filter,$http,$templateCache,$modal){$scope.navCollapsed=!0,$scope.isTypeClosed=!1,$scope.isCircClosed=!0,$scope.isTipsClosed=!0,$scope.isCircPanelOpen=!0,$scope.isAgeSelected=!1,$scope.navPos="0",$scope.isMc=function(){$scope.types.mc=!0,$scope.types.mcs=!1,$scope.types.mva=!1,$scope.step1()},$scope.isMcs=function(){$scope.types.mc=!1,$scope.types.mcs=!0,$scope.types.mva=!1,$scope.step1()},$scope.isMva=function(){$scope.types.mc=!1,$scope.types.mcs=!1,$scope.types.mva=!0,$scope.step1()},$scope.step1=function(){$scope.closeType(),$scope.openCirc()},$scope.step2=function(){$scope.closeCircPanel(),$scope.openTips()},$scope.go=function(){$scope.step2()},$scope.startOver=function(){$scope.navCollapsed=!0,$scope.toTop(),$scope.openType(),$scope.closeTips(),$scope.closeCirc(),$scope.openCircPanel(),$scope.types={mc:!1,mcs:!1,mva:!1},$scope.ages={ayc:!1,ac:!1,aa:!1},$scope.circs={alz:!1,dd:!1,ds:!1,aut:!1,abd:!1,run:!1,unk:!1,lwa:!1,med:!1,veh:!1,oft:!1}},$scope.toTop=function(ofTips){ofTips?window.matchMedia&&(window.matchMedia("(min-width: 767px)").matches?setTimeout(function(){window.scrollTo(0,130)},200):setTimeout(function(){window.scrollTo(0,185)},200)):window.scrollTo(0,0)},$scope.closeType=function(){$scope.isTypeClosed=!0},$scope.openType=function(){$scope.isTypeClosed=!1},$scope.closeCirc=function(){$scope.isCircClosed=!0},$scope.openCirc=function(){$scope.isCircClosed=!1},$scope.closeCircPanel=function(){$scope.isCircPanelOpen=!1},$scope.openCircPanel=function(){$scope.isCircPanelOpen=!0},$scope.closeTips=function(){$scope.isTipsClosed=!0},$scope.openTips=function(){$scope.isTipsClosed=!1},$scope.getNavPos=function(){return setTimeout(function(){$scope.navPos=document.getElementById("nav").getBoundingClientRect().top},500)},$scope.openInfo=function(){$modal.open({templateUrl:"about.htm",controller:AboutCtrl,modalClass:"modal-lg mobile-overflow"})};var AboutCtrl=function($scope,$modalInstance){$scope.ok=function(){$modalInstance.close()}};$scope.openStartOver=function(){var modalInstance=$modal.open({templateUrl:"startover.htm",controller:StartOverCtrl});modalInstance.result.then(function(isOk){isOk&&$scope.startOver()})};var StartOverCtrl=function($scope,$modalInstance){$scope.ok=function(){$modalInstance.close($scope.resetOK=!0)},$scope.cancel=function(){$modalInstance.close()}};$scope.types={mc:!1,mcs:!1,mva:!1},$scope.ages={ayc:!1,ac:!1,aa:!1},$scope.circs={alz:!1,dd:!1,ds:!1,aut:!1,abd:!1,run:!1,unk:!1,lwa:!1,med:!1,veh:!1,oft:!1},$http({method:"get",url:"data/tips.json"}).success(function(data){$scope.tips=data[0].tips,$scope.resources=data[0].resources}).error(function(){})}]),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.transition","ui.bootstrap.collapse","ui.bootstrap.accordion","ui.bootstrap.modal"]),angular.module("ui.bootstrap.tpls",["template/accordion/accordion-group.html","template/accordion/accordion.html","template/modal/backdrop.html","template/modal/window.html"]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function($q,$timeout,$rootScope){function findEndEventName(endEventNames){for(var name in endEventNames)if(void 0!==transElement.style[name])return endEventNames[name]}var $transition=function(element,trigger,options){options=options||{};var deferred=$q.defer(),endEventName=$transition[options.animation?"animationEndEventName":"transitionEndEventName"],transitionEndHandler=function(){$rootScope.$apply(function(){element.unbind(endEventName,transitionEndHandler),deferred.resolve(element)})};return endEventName&&element.bind(endEventName,transitionEndHandler),$timeout(function(){angular.isString(trigger)?element.addClass(trigger):angular.isFunction(trigger)?trigger(element):angular.isObject(trigger)&&element.css(trigger),endEventName||deferred.resolve(element)}),deferred.promise.cancel=function(){endEventName&&element.unbind(endEventName,transitionEndHandler),deferred.reject("Transition cancelled")},deferred.promise},transElement=document.createElement("trans"),transitionEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},animationEndEventNames={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return $transition.transitionEndEventName=findEndEventName(transitionEndEventNames),$transition.animationEndEventName=findEndEventName(animationEndEventNames),$transition}]),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function($transition){return{link:function(scope,element,attrs){function doTransition(change){function newTransitionDone(){currentTransition===newTransition&&(currentTransition=void 0)}var newTransition=$transition(element,change);return currentTransition&&currentTransition.cancel(),currentTransition=newTransition,newTransition.then(newTransitionDone,newTransitionDone),newTransition}function expand(){initialAnimSkip?(initialAnimSkip=!1,expandDone()):(element.removeClass("collapse").addClass("collapsing"),doTransition({height:element[0].scrollHeight+"px"}).then(expandDone))}function expandDone(){element.removeClass("collapsing"),element.addClass("collapse in"),element.css({height:"auto"})}function collapse(){if(initialAnimSkip)initialAnimSkip=!1,collapseDone(),element.css({height:0});else{element.css({height:element[0].scrollHeight+"px"});{element[0].offsetWidth}element.removeClass("collapse in").addClass("collapsing"),doTransition({height:0}).then(collapseDone)}}function collapseDone(){element.removeClass("collapsing"),element.addClass("collapse")}var currentTransition,initialAnimSkip=!0;scope.$watch(attrs.collapse,function(shouldCollapse){shouldCollapse?collapse():expand()})}}}]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function($scope,$attrs,accordionConfig){this.groups=[],this.closeOthers=function(openGroup){var closeOthers=angular.isDefined($attrs.closeOthers)?$scope.$eval($attrs.closeOthers):accordionConfig.closeOthers;closeOthers&&angular.forEach(this.groups,function(group){group!==openGroup&&(group.isOpen=!1)})},this.addGroup=function(groupScope){var that=this;this.groups.push(groupScope),groupScope.$on("$destroy",function(){that.removeGroup(groupScope)})},this.removeGroup=function(group){var index=this.groups.indexOf(group);-1!==index&&this.groups.splice(this.groups.indexOf(group),1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",["$parse",function($parse){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@"},controller:function(){this.setHeading=function(element){this.heading=element}},link:function(scope,element,attrs,accordionCtrl){var getIsOpen,setIsOpen;accordionCtrl.addGroup(scope),scope.isOpen=!1,attrs.isOpen&&(getIsOpen=$parse(attrs.isOpen),setIsOpen=getIsOpen.assign,scope.$parent.$watch(getIsOpen,function(value){scope.isOpen=!!value})),scope.$watch("isOpen",function(value){value&&accordionCtrl.closeOthers(scope),setIsOpen&&setIsOpen(scope.$parent,value)})}}}]).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",compile:function(element,attr,transclude){return function(scope,element,attr,accordionGroupCtrl){accordionGroupCtrl.setHeading(transclude(scope,function(){}))}}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(scope,element,attr,controller){scope.$watch(function(){return controller[attr.accordionTransclude]},function(heading){heading&&(element.html(""),element.append(heading))})}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var stack=[];return{add:function(key,value){stack.push({key:key,value:value})},get:function(key){for(var i=0;i<stack.length;i++)if(key==stack[i].key)return stack[i]},keys:function(){for(var keys=[],i=0;i<stack.length;i++)keys.push(stack[i].key);return keys},top:function(){return stack[stack.length-1]},remove:function(key){for(var idx=-1,i=0;i<stack.length;i++)if(key==stack[i].key){idx=i;break}return stack.splice(idx,1)[0]},removeTop:function(){return stack.splice(stack.length-1,1)[0]},length:function(){return stack.length}}}}}).directive("modalBackdrop",["$timeout",function($timeout){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(scope){scope.animate=!1,$timeout(function(){scope.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function($modalStack,$timeout){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:"template/modal/window.html",link:function(scope,element,attrs){scope.windowClass=attrs.windowClass||"",scope.modalClass=attrs.modalClass||"",$timeout(function(){scope.animate=!0,element[0].focus()}),scope.close=function(evt){var modal=$modalStack.getTop();modal&&modal.value.backdrop&&"static"!=modal.value.backdrop&&evt.target===evt.currentTarget&&(evt.preventDefault(),evt.stopPropagation(),$modalStack.dismiss(modal.key,"backdrop click"))}}}}]).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function($transition,$timeout,$document,$compile,$rootScope,$$stackedMap){function backdropIndex(){for(var topBackdropIndex=-1,opened=openedWindows.keys(),i=0;i<opened.length;i++)openedWindows.get(opened[i]).value.backdrop&&(topBackdropIndex=i);return topBackdropIndex}function removeModalWindow(modalInstance){var body=$document.find("body").eq(0),modalWindow=openedWindows.get(modalInstance).value;openedWindows.remove(modalInstance),removeAfterAnimate(modalWindow.modalDomEl,modalWindow.modalScope,300,checkRemoveBackdrop),body.toggleClass(OPENED_MODAL_CLASS,openedWindows.length()>0)}function checkRemoveBackdrop(){if(backdropDomEl&&-1==backdropIndex()){var backdropScopeRef=backdropScope;removeAfterAnimate(backdropDomEl,backdropScope,150,function(){backdropScopeRef.$destroy(),backdropScopeRef=null}),backdropDomEl=void 0,backdropScope=void 0}}function removeAfterAnimate(domEl,scope,emulateTime,done){function afterAnimating(){afterAnimating.done||(afterAnimating.done=!0,domEl.remove(),done&&done())}scope.animate=!1;var transitionEndEventName=$transition.transitionEndEventName;if(transitionEndEventName){var timeout=$timeout(afterAnimating,emulateTime);domEl.bind(transitionEndEventName,function(){$timeout.cancel(timeout),afterAnimating(),scope.$apply()})}else $timeout(afterAnimating,0)}var backdropDomEl,backdropScope,OPENED_MODAL_CLASS="modal-open",openedWindows=$$stackedMap.createNew(),$modalStack={};return $rootScope.$watch(backdropIndex,function(newBackdropIndex){backdropScope&&(backdropScope.index=newBackdropIndex)}),$document.bind("keydown",function(evt){var modal;27===evt.which&&(modal=openedWindows.top(),modal&&modal.value.keyboard&&$rootScope.$apply(function(){$modalStack.dismiss(modal.key)}))}),$modalStack.open=function(modalInstance,modal){openedWindows.add(modalInstance,{deferred:modal.deferred,modalScope:modal.scope,backdrop:modal.backdrop,keyboard:modal.keyboard});var body=$document.find("body").eq(0),currBackdropIndex=backdropIndex();currBackdropIndex>=0&&!backdropDomEl&&(backdropScope=$rootScope.$new(!0),backdropScope.index=currBackdropIndex,backdropDomEl=$compile("<div modal-backdrop></div>")(backdropScope),body.append(backdropDomEl));var angularDomEl=angular.element("<div modal-window></div>");angularDomEl.attr("window-class",modal.windowClass),angularDomEl.attr("modal-class",modal.modalClass),angularDomEl.attr("index",openedWindows.length()-1),angularDomEl.attr("animate","animate"),angularDomEl.html(modal.content);var modalDomEl=$compile(angularDomEl)(modal.scope);openedWindows.top().value.modalDomEl=modalDomEl,body.append(modalDomEl),body.addClass(OPENED_MODAL_CLASS)},$modalStack.close=function(modalInstance,result){var modalWindow=openedWindows.get(modalInstance).value;modalWindow&&(modalWindow.deferred.resolve(result),removeModalWindow(modalInstance))},$modalStack.dismiss=function(modalInstance,reason){var modalWindow=openedWindows.get(modalInstance).value;modalWindow&&(modalWindow.deferred.reject(reason),removeModalWindow(modalInstance))},$modalStack.dismissAll=function(reason){for(var topModal=this.getTop();topModal;)this.dismiss(topModal.key,reason),topModal=this.getTop()},$modalStack.getTop=function(){return openedWindows.top()},$modalStack}]).provider("$modal",function(){var $modalProvider={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function($injector,$rootScope,$q,$http,$templateCache,$controller,$modalStack){function getTemplatePromise(options){return options.template?$q.when(options.template):$http.get(options.templateUrl,{cache:$templateCache}).then(function(result){return result.data})}function getResolvePromises(resolves){var promisesArr=[];return angular.forEach(resolves,function(value){(angular.isFunction(value)||angular.isArray(value))&&promisesArr.push($q.when($injector.invoke(value)))}),promisesArr}var $modal={};return $modal.open=function(modalOptions){var modalResultDeferred=$q.defer(),modalOpenedDeferred=$q.defer(),modalInstance={result:modalResultDeferred.promise,opened:modalOpenedDeferred.promise,close:function(result){$modalStack.close(modalInstance,result)},dismiss:function(reason){$modalStack.dismiss(modalInstance,reason)}};if(modalOptions=angular.extend({},$modalProvider.options,modalOptions),modalOptions.resolve=modalOptions.resolve||{},!modalOptions.template&&!modalOptions.templateUrl)throw new Error("One of template or templateUrl options is required.");var templateAndResolvePromise=$q.all([getTemplatePromise(modalOptions)].concat(getResolvePromises(modalOptions.resolve)));return templateAndResolvePromise.then(function(tplAndVars){var modalScope=(modalOptions.scope||$rootScope).$new();modalScope.$close=modalInstance.close,modalScope.$dismiss=modalInstance.dismiss;var ctrlInstance,ctrlLocals={},resolveIter=1;modalOptions.controller&&(ctrlLocals.$scope=modalScope,ctrlLocals.$modalInstance=modalInstance,angular.forEach(modalOptions.resolve,function(value,key){ctrlLocals[key]=tplAndVars[resolveIter++]}),ctrlInstance=$controller(modalOptions.controller,ctrlLocals)),$modalStack.open(modalInstance,{scope:modalScope,deferred:modalResultDeferred,content:tplAndVars[0],backdrop:modalOptions.backdrop,keyboard:modalOptions.keyboard,windowClass:modalOptions.windowClass,modalClass:modalOptions.modalClass})},function(reason){modalResultDeferred.reject(reason)}),templateAndResolvePromise.then(function(){modalOpenedDeferred.resolve(!0)},function(){modalOpenedDeferred.reject(!1)}),modalInstance},$modal}]};return $modalProvider}),angular.module("template/accordion/accordion-group.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion-group.html",'<div class="panel panel-default">\n  <div class="panel-heading">\n    <h4 class="panel-title">\n      <a class="accordion-toggle" ng-click="isOpen = !isOpen" accordion-transclude="heading">{{heading}}</a>\n    </h4>\n  </div>\n  <div class="panel-collapse" collapse="!isOpen">\n    <div class="panel-body" ng-transclude></div>\n  </div>\n</div>')}]),angular.module("template/accordion/accordion.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/accordion/accordion.html",'<div class="panel-group" ng-transclude></div>')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/backdrop.html",'<div class="modal-backdrop fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1040 + index*10}"></div>')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("template/modal/window.html",'<div tabindex="-1" class="modal fade {{ windowClass }}" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog {{ modalClass }}"><div class="modal-content" ng-transclude></div></div>\n</div>')}]),angular.module("TipsApp.filters",[]).filter("typeFilter",function(){return function(items,types){var filtered=[];return angular.forEach(items,function(item){var type=item.type;type.indexOf("all")>=0?filtered.push(item):types.mc===!0&&type.indexOf("mc")>=0?filtered.push(item):types.mcs===!0&&type.indexOf("mcs")>=0?filtered.push(item):types.mva===!0&&type.indexOf("mva")>=0&&filtered.push(item)}),filtered}}).filter("circFilter",function(){return function(items,circs){var filtered=[];return angular.forEach(items,function(item){var circ=item.circ;circ.indexOf("all")>=0||!circ?filtered.push(item):circs.alz===!0&&circ.indexOf("alz")>=0?filtered.push(item):circs.dd===!0&&circ.indexOf("dd")>=0?filtered.push(item):circs.ds===!0&&circ.indexOf("ds")>=0?filtered.push(item):circs.aut===!0&&circ.indexOf("aut")>=0?filtered.push(item):circs.abd===!0&&circ.indexOf("abd")>=0?filtered.push(item):circs.run===!0&&circ.indexOf("run")>=0?filtered.push(item):circs.unk===!0&&circ.indexOf("unk")>=0?filtered.push(item):circs.lwa===!0&&circ.indexOf("lwa")>=0?filtered.push(item):circs.med===!0&&circ.indexOf("med")>=0?filtered.push(item):circs.veh===!0&&circ.indexOf("veh")>=0?filtered.push(item):circs.oft===!0&&circ.indexOf("oft")>=0&&filtered.push(item)}),filtered}}).filter("ageFilter",function(){return function(items,ages){var filtered=[];return angular.forEach(items,function(item){var age=item.age;age.indexOf("all")>=0?filtered.push(item):ages.ayc===!0&&age.indexOf("ayc")>=0?filtered.push(item):ages.ac===!0&&age.indexOf("ac")>=0?filtered.push(item):ages.aa===!0&&age.indexOf("aa")>=0&&filtered.push(item)}),filtered}}),angular.module("ngScrollSpy",[]).directive("scrollspyBroadcast",["$rootScope",function($rootScope){return{restrict:"A",scope:{},link:function(scope,element,attrs){scope.activate=function(){scope.documentHeight=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight),scope.userScrolledTop=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,scope.userScrolledBottom=scope.userScrolledTop+window.innerHeight,scope.elementOffsetTop=element[0].offsetTop,scope.elementOffsetBottom=scope.elementOffsetTop+Math.max(element[0].scrollHeight,element[0].offsetHeight),scope.triggerOffset=0,scope.elementOffsetTop-scope.triggerOffset<scope.documentHeight-window.innerHeight?(scope.elementOffsetTop<=scope.userScrolledTop+scope.triggerOffset&&$rootScope.$broadcast("spied",{activeSpy:attrs.id}),0===scope.userScrolledTop&&$rootScope.$broadcast("atTop")):scope.userScrolledBottom>scope.elementOffsetBottom-scope.triggerOffset&&$rootScope.$broadcast("spied",{activeSpy:attrs.id})},angular.element(window).bind("scroll",function(){scope.activate()})}}}]).directive("scrollspyListen",["$rootScope",function($rootScope){return{restrict:"A",scope:{scrollspyListen:"@",enabled:"@"},replace:!0,transclude:!0,template:function(element){var tag=element[0].nodeName;return"<"+tag+' data-ng-transclude data-ng-class="{active: enabled}"></'+tag+">"},link:function(scope){$rootScope.$on("spied",function(event,args){scope.enabled=!1,scope.scrollspyListen===args.activeSpy&&(scope.enabled=!0),scope.$$phase||scope.$digest()})}}}]).directive("scrollspyNav",["$rootScope",function($rootScope){return{restrict:"A",scope:{isAffixedSmall:"@",isAffixedLarge:"@"},replace:!0,transclude:!0,template:function(element){var tag=element[0].nodeName;return"<"+tag+" data-ng-transclude data-ng-class=\"{'navbar-fixed-top': isAffixedSmall, affix: isAffixedLarge, 'col-sm-3': isAffixedLarge}\"></"+tag+">"},link:function(scope,element){$rootScope.$on("spied",function(){scope.currentScroll=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,scope.isVisible=element[0].offsetWidth>0||element[0].offsetHeight>0,scope.isVisible&&scope.currentScroll>=155?window.matchMedia&&(window.matchMedia("(min-width: 767px)").matches?scope.isAffixedLarge=!0:scope.isAffixedSmall=!0):(scope.isAffixedSmall=!1,scope.isAffixedLarge=!1),scope.$$phase||scope.$digest()}),$rootScope.$on("atTop",function(){scope.isAffixedSmall=!1,scope.isAffixedLarge=!1,scope.$$phase||scope.$digest()})}}}]);